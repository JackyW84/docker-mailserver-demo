#! /bin/bash

# shellcheck source=../scripts/helpers/index.sh
source /usr/local/bin/helpers/index.sh

source ./common/virtual-aliases.sh

function _main
{
  [[ ${1:-} == 'help' ]] && { __usage ; exit 0 ; }

  local MAIL_ALIAS="${1}"
  local RECIPIENT="${2}"

  _validate_parameters
  _alias_add_for_recipient "${MAIL_ALIAS}" "${RECIPIENT}"
}

function __usage
{
  printf '%s' "${PURPLE}ADDALIAS${RED}(${YELLOW}8${RED})

${ORANGE}NAME${RESET}
    addalias - add an email alias for an existing user

${ORANGE}SYNOPSIS${RESET}
    ./setup.sh alias add <MAIL ALIAS> <RECIPIENT>

${ORANGE}OPTIONS${RESET}
    ${BLUE}Generic Program Information${RESET}
        help       Print the usage information.

${ORANGE}EXAMPLES${RESET}
    ${LWHITE}./setup.sh alias add alias-for-me@domain.tld admin@domain.tld${RESET}
        Add the alias alias-for-me@doamin.tld for the existing user
        admin@domain.tld.

${ORANGE}EXIT STATUS${RESET}
    Exit status is 0 if command was successful. If wrong arguments are provided
    or arguments contain errors, the script will exit early with exit status 1.

"
}

function _validate_parameters
{
  _arg_expect_alias_and_recipient
}

_main "${@}"
