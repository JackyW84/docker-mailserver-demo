#! /bin/bash

# shellcheck source=../scripts/helpers/index.sh
source /usr/local/bin/helpers/index.sh

function _main
{
  local DOMAIN="${1}"

  _validate_parameters
  _exclude_domain_from_relayhosts
}

function __usage { echo 'Usage: excluderelayhost <domain>' ; }

function _validate_parameters
{
  _arg_expect_domain
}

# Config is for sender dependent relay-host mapping,
# excludes appending a sender from the real generated mapping in `helpers/relay.sh`.
function _exclude_domain_from_relayhosts
{
  local SENDER="@${DOMAIN}"
  local DATABASE_RELAY='/tmp/docker-mailserver/postfix-relaymap.cf'

  _db_add_or_replace_entry "${SENDER}" "${SENDER}" "${DATABASE_RELAY}"
}

_main "${@}"
